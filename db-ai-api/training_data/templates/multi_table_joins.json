{
  "domain": "multi_table",
  "description": "Complex 3-5 table JOIN pattern examples - CRITICAL for correct query generation",
  "tables": [
    "Client",
    "ClientAgreement",
    "Order",
    "OrderItem",
    "Product",
    "Sale",
    "Region",
    "Storage",
    "ProductAvailability",
    "Category"
  ],
  "examples": [
    {
      "id": "client_orders_chain_001",
      "category": "join_pattern",
      "complexity": "critical",
      "question_en": "Get all orders for a client",
      "question_uk": "Отримати всі замовлення клієнта",
      "variations_en": ["client orders", "orders by client", "customer orders", "show orders for client"],
      "variations_uk": ["замовлення клієнта", "замовлення по клієнту", "покажи замовлення клієнта"],
      "sql": "SELECT o.ID, o.Created, o.TotalSum, c.Name as ClientName FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE c.Deleted = 0 AND ca.Deleted = 0 AND o.Deleted = 0 ORDER BY o.Created DESC",
      "tables_used": ["Client", "ClientAgreement", "Order"],
      "critical_note": "NEVER use Order.ClientID - it does not exist! Always use ClientAgreement as bridge."
    },
    {
      "id": "client_order_items_chain_002",
      "category": "join_pattern",
      "complexity": "complex",
      "question_en": "Products ordered by each client",
      "question_uk": "Товари замовлені кожним клієнтом",
      "variations_en": ["client product orders", "what did clients buy", "client purchases"],
      "variations_uk": ["що замовляли клієнти", "товари клієнтів", "покупки клієнтів"],
      "sql": "SELECT c.Name as ClientName, p.Name as ProductName, SUM(oi.Qty) as TotalQty FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID JOIN dbo.OrderItem oi ON oi.OrderID = o.ID JOIN dbo.Product p ON oi.ProductID = p.ID WHERE c.Deleted = 0 AND o.Deleted = 0 GROUP BY c.ID, c.Name, p.ID, p.Name ORDER BY c.Name, TotalQty DESC",
      "tables_used": ["Client", "ClientAgreement", "Order", "OrderItem", "Product"],
      "critical_note": "5-table chain: Client -> ClientAgreement -> Order -> OrderItem -> Product"
    },
    {
      "id": "client_sales_chain_003",
      "category": "join_pattern",
      "complexity": "complex",
      "question_en": "Client sales with order details",
      "question_uk": "Продажі клієнтів з деталями замовлень",
      "variations_en": ["sales by client", "client purchase history"],
      "variations_uk": ["продажі клієнтів", "історія покупок"],
      "sql": "SELECT c.Name as ClientName, s.SaleDate, s.TotalSum, o.Created as OrderDate FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.Sale s ON s.ClientAgreementID = ca.ID JOIN dbo.[Order] o ON s.OrderID = o.ID WHERE c.Deleted = 0 AND s.Deleted = 0 ORDER BY s.SaleDate DESC",
      "tables_used": ["Client", "ClientAgreement", "Sale", "Order"]
    },
    {
      "id": "product_stock_by_storage_004",
      "category": "list",
      "complexity": "medium",
      "question_en": "Product availability by warehouse",
      "question_uk": "Залишки товарів по складах",
      "variations_en": ["stock by warehouse", "inventory per storage"],
      "variations_uk": ["залишки по складах", "товари на складах"],
      "sql": "SELECT p.Name as ProductName, s.Name as StorageName, pa.Amount as Stock FROM dbo.Product p JOIN dbo.ProductAvailability pa ON pa.ProductID = p.ID JOIN dbo.Storage s ON pa.StorageID = s.ID WHERE p.Deleted = 0 AND pa.Amount > 0 ORDER BY p.Name, s.Name",
      "tables_used": ["Product", "ProductAvailability", "Storage"]
    },
    {
      "id": "order_region_chain_005",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Orders by client region",
      "question_uk": "Замовлення по регіонах клієнтів",
      "variations_en": ["orders per region", "regional order distribution"],
      "variations_uk": ["замовлення по регіонах", "розподіл по регіонах"],
      "sql": "SELECT r.Name as RegionName, COUNT(o.ID) as OrderCount, SUM(o.TotalSum) as TotalAmount FROM dbo.Region r JOIN dbo.Client c ON c.RegionID = r.ID JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE r.Deleted = 0 AND o.Deleted = 0 GROUP BY r.ID, r.Name ORDER BY TotalAmount DESC",
      "tables_used": ["Region", "Client", "ClientAgreement", "Order"]
    },
    {
      "id": "sale_product_category_006",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Sales by product category",
      "question_uk": "Продажі по категоріях товарів",
      "variations_en": ["category sales", "revenue by product type"],
      "variations_uk": ["продажі по категоріях", "виручка по типах"],
      "sql": "SELECT cat.Name as CategoryName, SUM(oi.Qty * oi.PricePerItem) as TotalSales FROM dbo.Category cat JOIN dbo.Product p ON p.CategoryID = cat.ID JOIN dbo.OrderItem oi ON oi.ProductID = p.ID JOIN dbo.[Order] o ON oi.OrderID = o.ID WHERE cat.Deleted = 0 AND o.Deleted = 0 GROUP BY cat.ID, cat.Name ORDER BY TotalSales DESC",
      "tables_used": ["Category", "Product", "OrderItem", "Order"]
    },
    {
      "id": "client_order_count_007",
      "category": "aggregation",
      "complexity": "medium",
      "question_en": "Number of orders per client",
      "question_uk": "Кількість замовлень по клієнтах",
      "variations_en": ["order count by client", "how many orders per customer"],
      "variations_uk": ["скільки замовлень у клієнта", "замовлення клієнтів"],
      "sql": "SELECT c.Name as ClientName, COUNT(o.ID) as OrderCount FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE c.Deleted = 0 AND o.Deleted = 0 GROUP BY c.ID, c.Name ORDER BY OrderCount DESC",
      "tables_used": ["Client", "ClientAgreement", "Order"],
      "critical_note": "Path: Client -> ClientAgreement -> Order (NOT Order.ClientID)"
    },
    {
      "id": "client_total_purchases_008",
      "category": "aggregation",
      "complexity": "medium",
      "question_en": "Total purchase amount per client",
      "question_uk": "Загальна сума покупок по клієнтах",
      "variations_en": ["client totals", "spending by customer"],
      "variations_uk": ["витрати клієнтів", "сума покупок"],
      "sql": "SELECT c.Name as ClientName, SUM(o.TotalSum) as TotalPurchases FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE c.Deleted = 0 AND o.Deleted = 0 GROUP BY c.ID, c.Name ORDER BY TotalPurchases DESC",
      "tables_used": ["Client", "ClientAgreement", "Order"],
      "critical_note": "Always use ClientAgreement bridge for Client-Order joins"
    },
    {
      "id": "product_sales_with_client_009",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Products sold with client information",
      "question_uk": "Продані товари з інформацією про клієнтів",
      "variations_en": ["product sales by client", "who bought which products"],
      "variations_uk": ["товари по клієнтах", "хто що купував"],
      "sql": "SELECT p.Name as ProductName, c.Name as ClientName, SUM(oi.Qty) as QuantitySold FROM dbo.Product p JOIN dbo.OrderItem oi ON oi.ProductID = p.ID JOIN dbo.[Order] o ON oi.OrderID = o.ID JOIN dbo.ClientAgreement ca ON o.ClientAgreementID = ca.ID JOIN dbo.Client c ON ca.ClientID = c.ID WHERE p.Deleted = 0 AND o.Deleted = 0 GROUP BY p.ID, p.Name, c.ID, c.Name ORDER BY QuantitySold DESC",
      "tables_used": ["Product", "OrderItem", "Order", "ClientAgreement", "Client"]
    },
    {
      "id": "order_items_with_product_details_010",
      "category": "list",
      "complexity": "medium",
      "question_en": "Order items with product details",
      "question_uk": "Позиції замовлень з деталями товарів",
      "variations_en": ["order line items with products", "what's in orders"],
      "variations_uk": ["позиції замовлень", "товари в замовленнях"],
      "sql": "SELECT o.ID as OrderID, o.Created, p.Name as ProductName, oi.Qty, oi.PricePerItem FROM dbo.[Order] o JOIN dbo.OrderItem oi ON oi.OrderID = o.ID JOIN dbo.Product p ON oi.ProductID = p.ID WHERE o.Deleted = 0 AND oi.Deleted = 0 ORDER BY o.Created DESC",
      "tables_used": ["Order", "OrderItem", "Product"]
    },
    {
      "id": "top_products_by_client_011",
      "category": "ranking",
      "complexity": "complex",
      "question_en": "Top products for each client",
      "question_uk": "Топ товари по клієнтах",
      "variations_en": ["most ordered products per client", "client favorite products"],
      "variations_uk": ["улюблені товари клієнтів", "найпопулярніші товари"],
      "sql": "SELECT TOP 50 c.Name as ClientName, p.Name as ProductName, SUM(oi.Qty) as TotalQty FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID JOIN dbo.OrderItem oi ON oi.OrderID = o.ID JOIN dbo.Product p ON oi.ProductID = p.ID WHERE c.Deleted = 0 AND o.Deleted = 0 GROUP BY c.ID, c.Name, p.ID, p.Name ORDER BY TotalQty DESC",
      "tables_used": ["Client", "ClientAgreement", "Order", "OrderItem", "Product"]
    },
    {
      "id": "sales_by_region_012",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Total sales by region",
      "question_uk": "Продажі по регіонах",
      "variations_en": ["regional sales", "revenue per region"],
      "variations_uk": ["виручка по регіонах", "продажі по областях"],
      "sql": "SELECT r.Name as RegionName, SUM(s.TotalSum) as TotalSales, COUNT(s.ID) as SaleCount FROM dbo.Region r JOIN dbo.Client c ON c.RegionID = r.ID JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.Sale s ON s.ClientAgreementID = ca.ID WHERE r.Deleted = 0 AND s.Deleted = 0 GROUP BY r.ID, r.Name ORDER BY TotalSales DESC",
      "tables_used": ["Region", "Client", "ClientAgreement", "Sale"]
    },
    {
      "id": "client_last_order_013",
      "category": "aggregation",
      "complexity": "medium",
      "question_en": "Last order date for each client",
      "question_uk": "Дата останнього замовлення по клієнтах",
      "variations_en": ["when did clients last order", "recent client activity"],
      "variations_uk": ["коли клієнт останній раз замовляв", "активність клієнтів"],
      "sql": "SELECT c.Name as ClientName, MAX(o.Created) as LastOrderDate FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE c.Deleted = 0 AND o.Deleted = 0 GROUP BY c.ID, c.Name ORDER BY LastOrderDate DESC",
      "tables_used": ["Client", "ClientAgreement", "Order"]
    },
    {
      "id": "product_orders_by_region_014",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Product orders by client region",
      "question_uk": "Замовлення товарів по регіонах клієнтів",
      "variations_en": ["regional product sales", "products per region"],
      "variations_uk": ["товари по регіонах", "продажі по областях"],
      "sql": "SELECT r.Name as RegionName, p.Name as ProductName, SUM(oi.Qty) as TotalQty FROM dbo.Region r JOIN dbo.Client c ON c.RegionID = r.ID JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID JOIN dbo.OrderItem oi ON oi.OrderID = o.ID JOIN dbo.Product p ON oi.ProductID = p.ID WHERE r.Deleted = 0 AND o.Deleted = 0 GROUP BY r.ID, r.Name, p.ID, p.Name ORDER BY TotalQty DESC",
      "tables_used": ["Region", "Client", "ClientAgreement", "Order", "OrderItem", "Product"]
    },
    {
      "id": "inactive_clients_015",
      "category": "filter",
      "complexity": "complex",
      "question_en": "Clients without orders in 6 months",
      "question_uk": "Клієнти без замовлень за 6 місяців",
      "variations_en": ["inactive customers", "dormant clients"],
      "variations_uk": ["неактивні клієнти", "клієнти без замовлень"],
      "sql": "SELECT c.Name as ClientName, MAX(o.Created) as LastOrderDate FROM dbo.Client c LEFT JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID LEFT JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID AND o.Deleted = 0 WHERE c.Deleted = 0 GROUP BY c.ID, c.Name HAVING MAX(o.Created) IS NULL OR MAX(o.Created) < DATEADD(month, -6, GETDATE()) ORDER BY LastOrderDate",
      "tables_used": ["Client", "ClientAgreement", "Order"]
    },
    {
      "id": "order_with_all_details_016",
      "category": "list",
      "complexity": "complex",
      "question_en": "Full order details with client and products",
      "question_uk": "Повні деталі замовлення з клієнтом та товарами",
      "variations_en": ["complete order info", "order with all information"],
      "variations_uk": ["повна інформація про замовлення", "замовлення з деталями"],
      "sql": "SELECT o.ID as OrderID, o.Created, c.Name as ClientName, p.Name as ProductName, oi.Qty, oi.PricePerItem, (oi.Qty * oi.PricePerItem) as LineTotal FROM dbo.[Order] o JOIN dbo.ClientAgreement ca ON o.ClientAgreementID = ca.ID JOIN dbo.Client c ON ca.ClientID = c.ID JOIN dbo.OrderItem oi ON oi.OrderID = o.ID JOIN dbo.Product p ON oi.ProductID = p.ID WHERE o.Deleted = 0 ORDER BY o.Created DESC",
      "tables_used": ["Order", "ClientAgreement", "Client", "OrderItem", "Product"]
    },
    {
      "id": "category_sales_by_region_017",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Category sales by region",
      "question_uk": "Продажі категорій по регіонах",
      "variations_en": ["regional category sales", "categories per region"],
      "variations_uk": ["категорії по регіонах", "продажі категорій"],
      "sql": "SELECT r.Name as RegionName, cat.Name as CategoryName, SUM(oi.Qty * oi.PricePerItem) as TotalSales FROM dbo.Region r JOIN dbo.Client c ON c.RegionID = r.ID JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID JOIN dbo.OrderItem oi ON oi.OrderID = o.ID JOIN dbo.Product p ON oi.ProductID = p.ID JOIN dbo.Category cat ON p.CategoryID = cat.ID WHERE r.Deleted = 0 AND o.Deleted = 0 GROUP BY r.ID, r.Name, cat.ID, cat.Name ORDER BY TotalSales DESC",
      "tables_used": ["Region", "Client", "ClientAgreement", "Order", "OrderItem", "Product", "Category"]
    },
    {
      "id": "client_agreement_orders_018",
      "category": "list",
      "complexity": "medium",
      "question_en": "Orders for each client agreement",
      "question_uk": "Замовлення по договорах клієнтів",
      "variations_en": ["orders by agreement", "agreement orders"],
      "variations_uk": ["замовлення по договорах", "договори та замовлення"],
      "sql": "SELECT c.Name as ClientName, ca.Name as AgreementName, COUNT(o.ID) as OrderCount, SUM(o.TotalSum) as TotalAmount FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE c.Deleted = 0 AND o.Deleted = 0 GROUP BY c.ID, c.Name, ca.ID, ca.Name ORDER BY TotalAmount DESC",
      "tables_used": ["Client", "ClientAgreement", "Order"]
    },
    {
      "id": "storage_product_quantity_019",
      "category": "aggregation",
      "complexity": "medium",
      "question_en": "Total stock by storage",
      "question_uk": "Загальні залишки по складах",
      "variations_en": ["inventory by warehouse", "stock per storage"],
      "variations_uk": ["залишки по складах", "інвентар складів"],
      "sql": "SELECT s.Name as StorageName, COUNT(DISTINCT pa.ProductID) as ProductCount, SUM(pa.Amount) as TotalStock FROM dbo.Storage s JOIN dbo.ProductAvailability pa ON pa.StorageID = s.ID WHERE s.Deleted = 0 AND pa.Amount > 0 GROUP BY s.ID, s.Name ORDER BY TotalStock DESC",
      "tables_used": ["Storage", "ProductAvailability"]
    },
    {
      "id": "product_category_stock_020",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Stock by product category and storage",
      "question_uk": "Залишки по категоріях та складах",
      "variations_en": ["category inventory by warehouse"],
      "variations_uk": ["залишки категорій по складах"],
      "sql": "SELECT cat.Name as CategoryName, s.Name as StorageName, SUM(pa.Amount) as TotalStock FROM dbo.Category cat JOIN dbo.Product p ON p.CategoryID = cat.ID JOIN dbo.ProductAvailability pa ON pa.ProductID = p.ID JOIN dbo.Storage s ON pa.StorageID = s.ID WHERE cat.Deleted = 0 AND pa.Amount > 0 GROUP BY cat.ID, cat.Name, s.ID, s.Name ORDER BY TotalStock DESC",
      "tables_used": ["Category", "Product", "ProductAvailability", "Storage"]
    },
    {
      "id": "client_products_by_category_021",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "What categories do clients buy",
      "question_uk": "Які категорії купують клієнти",
      "variations_en": ["client purchases by category", "category preferences"],
      "variations_uk": ["категорії покупок клієнтів", "вподобання клієнтів"],
      "sql": "SELECT c.Name as ClientName, cat.Name as CategoryName, SUM(oi.Qty) as TotalQty FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID JOIN dbo.OrderItem oi ON oi.OrderID = o.ID JOIN dbo.Product p ON oi.ProductID = p.ID JOIN dbo.Category cat ON p.CategoryID = cat.ID WHERE c.Deleted = 0 AND o.Deleted = 0 GROUP BY c.ID, c.Name, cat.ID, cat.Name ORDER BY TotalQty DESC",
      "tables_used": ["Client", "ClientAgreement", "Order", "OrderItem", "Product", "Category"]
    },
    {
      "id": "sale_order_client_chain_022",
      "category": "list",
      "complexity": "complex",
      "question_en": "Sales with order and client details",
      "question_uk": "Продажі з деталями замовлення та клієнта",
      "variations_en": ["complete sale info"],
      "variations_uk": ["повна інформація про продаж"],
      "sql": "SELECT s.ID as SaleID, s.SaleDate, s.TotalSum, o.ID as OrderID, c.Name as ClientName FROM dbo.Sale s JOIN dbo.[Order] o ON s.OrderID = o.ID JOIN dbo.ClientAgreement ca ON s.ClientAgreementID = ca.ID JOIN dbo.Client c ON ca.ClientID = c.ID WHERE s.Deleted = 0 ORDER BY s.SaleDate DESC",
      "tables_used": ["Sale", "Order", "ClientAgreement", "Client"]
    },
    {
      "id": "monthly_sales_by_client_023",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Monthly sales by client",
      "question_uk": "Щомісячні продажі по клієнтах",
      "variations_en": ["client sales by month"],
      "variations_uk": ["продажі клієнтів по місяцях"],
      "sql": "SELECT c.Name as ClientName, YEAR(s.SaleDate) as Year, MONTH(s.SaleDate) as Month, SUM(s.TotalSum) as MonthlySales FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.Sale s ON s.ClientAgreementID = ca.ID WHERE c.Deleted = 0 AND s.Deleted = 0 GROUP BY c.ID, c.Name, YEAR(s.SaleDate), MONTH(s.SaleDate) ORDER BY Year DESC, Month DESC, MonthlySales DESC",
      "tables_used": ["Client", "ClientAgreement", "Sale"]
    },
    {
      "id": "new_clients_with_orders_024",
      "category": "filter",
      "complexity": "complex",
      "question_en": "New clients (created this year) with orders",
      "question_uk": "Нові клієнти (за цей рік) з замовленнями",
      "variations_en": ["recent clients who ordered"],
      "variations_uk": ["нові клієнти із замовленнями"],
      "sql": "SELECT c.Name as ClientName, c.Created as ClientCreated, COUNT(o.ID) as OrderCount, SUM(o.TotalSum) as TotalOrders FROM dbo.Client c JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE c.Deleted = 0 AND YEAR(c.Created) = YEAR(GETDATE()) AND o.Deleted = 0 GROUP BY c.ID, c.Name, c.Created ORDER BY TotalOrders DESC",
      "tables_used": ["Client", "ClientAgreement", "Order"]
    },
    {
      "id": "avg_order_value_by_region_025",
      "category": "aggregation",
      "complexity": "complex",
      "question_en": "Average order value by region",
      "question_uk": "Середній чек по регіонах",
      "variations_en": ["regional average order"],
      "variations_uk": ["середнє замовлення по регіонах"],
      "sql": "SELECT r.Name as RegionName, AVG(o.TotalSum) as AvgOrderValue, COUNT(o.ID) as OrderCount FROM dbo.Region r JOIN dbo.Client c ON c.RegionID = r.ID JOIN dbo.ClientAgreement ca ON ca.ClientID = c.ID JOIN dbo.[Order] o ON o.ClientAgreementID = ca.ID WHERE r.Deleted = 0 AND o.Deleted = 0 GROUP BY r.ID, r.Name ORDER BY AvgOrderValue DESC",
      "tables_used": ["Region", "Client", "ClientAgreement", "Order"]
    }
  ]
}
